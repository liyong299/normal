<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mopon.dao.log.AccessInLogDao" >
	
	<!-- 接口日志 -->
	<resultMap type="com.mopon.entity.log.AccessApiLog" id="AccinlogsResultMap">
		<id property="logID" column="LogID" />
		<result property="sysLogID" column="SysLogID" />
		<result property="accessProviderNo" column="AccessProviderNo" />
		<result property="apiName" column="ApiName" />
		<result property="apiUrl" column="ApiUrl" />
		<result property="inParam" column="InParam" />
		<result property="outParam" column="OutParam" />
		<result property="memo" column="Memo" />
		<result property="logStatus" column="LogStatus" />
		<result property="recTimeShow" column="RecTime" />
	</resultMap>
	
	<sql id="fieldList" >
	    LogID,
	    SysLogID,
	    AccessProviderNo,
	    ApiName,
	    ApiUrl,
	    InParam,
	    OutParam,
	    Memo,
	    LogStatus,
	    FROM_UNIXTIME( RecTime, '%Y-%m-%d %H:%i:%s' ) as RecTime
	</sql>
	<!-- 分页查询接入日志信息 -->
	<select id="queryPageList" parameterType="com.mopon.util.Page" resultMap="AccinlogsResultMap">
		SELECT  
     	<include refid="fieldList"></include>
     	from log_AccessApiLog 
		<where>
			1=1
	    	<if test="params.accessApiLog.accessProviderNo !=null  and params.accessApiLog.accessProviderNo!=''">
	    	  and  AccessProviderNo LIKE CONCAT("%",#{params.accessApiLog.accessProviderNo},"%")  
	    	</if>
			<if test="params.accessApiLog.apiName!=null and params.accessApiLog.apiName!=''">
				and ApiName LIKE CONCAT("%",#{params.accessApiLog.apiName},"%") 
			</if>			
			<if test="params.accessApiLog.memo !=null  and params.accessApiLog.memo!=''">
	    	    and Memo LIKE CONCAT("%",#{params.accessApiLog.memo},"%") 
	    	</if>
			<if test="params.accessApiLog.logStatus!=null and params.accessApiLog.logStatus!=''">
				and LogStatus=#{params.accessApiLog.logStatus}
			</if>
			<if test="params.accessApiLog.createDateBagin != null and params.accessApiLog.createDateBagin !='' " >
      			 and RecTime &gt;=  UNIX_TIMESTAMP(#{params.accessApiLog.createDateBagin})
		      </if>
		      <if test="params.accessApiLog.createDateEnd != null and params.accessApiLog.createDateEnd !='' " >
		      			 and RecTime &lt;=  UNIX_TIMESTAMP(#{params.accessApiLog.createDateEnd})
		      </if>
		</where>		
		ORDER BY RecTime DESC
	</select>

	<select id="queryAccessInLogsById" parameterType="java.lang.String" resultMap="AccinlogsResultMap">
	     SELECT 
	     <include refid="fieldList"></include>
	     from log_AccessApiLog
	     WHERE 
	     LogID = #{id}
	</select>	
	<insert id="insert" parameterType="com.mopon.entity.log.AccessApiLog">
	 INSERT INTO log_AccessApiLog
     (
	     SysLogID,
	     AccessProviderNo,
	     ApiName,
	     ApiUrl,
	     InParam,
	     OutParam,Memo,
	     LogStatus,
	     RecTime
     )
     VALUES
     (
	     #{sysLogID},
	     #{accessProviderNo},
	     #{apiName},
	     #{apiUrl},
	     #{inParam},
	     #{outParam},
	     #{logStatus},
	     #{recTime}
     )	
	</insert>		  
</mapper>