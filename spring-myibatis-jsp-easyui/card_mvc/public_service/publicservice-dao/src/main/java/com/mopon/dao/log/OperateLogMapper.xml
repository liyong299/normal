<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mopon.dao.log.OperateLogDao" >

<!-- 操作日志 -->
	<resultMap type="com.mopon.entity.log.OperaterLog" id="OperateLogsResultMap">
		<id property="logID" column="LogID" />
		<result property="sysLogID" column="SysLogID" />
		<result property="menuID" column="MenuID" />
		<result property="menuName" column="MenuName" />
		<result property="btnName" column="BtnName" />
		<result property="userID" column="UserID" />
		<result property="userName" column="UserName" />
		<result property="memo" column="Memo" />
		<result property="dataChangeInfos" column="DataChangeInfos" />
		<result property="logStatus" column="LogStatus" />
		<result property="recTimeShow" column="RecTime" />
	</resultMap>
	
	<sql id="fieldList" >
	   LogID,
	   SysLogID,
	   MenuID,
	   MenuName,
	   BtnName,
	   UserID,
	   UserName,
	   DataChangeInfos,
	   Memo,
	   LogStatus,
	   FROM_UNIXTIME( RecTime, '%Y-%m-%d %H:%i:%s' ) as RecTime
	</sql>
	
	<select id="queryPageList" parameterType="com.mopon.util.Page" resultMap="OperateLogsResultMap">
		SELECT  
     	<include refid="fieldList"></include>
     	from log_OperaterLog
		<where>
			1=1
	    	<if test="params.operaterLog.menuName !=null  and params.operaterLog.menuName!=''">
	    	    and MenuName LIKE  CONCAT("%",#{params.operaterLog.menuName},"%")
	    	</if>	    	
	    	<if test="params.operaterLog.btnName !=null  and params.operaterLog.btnName!=''">
	    	    and BtnName LIKE CONCAT("%",#{params.operaterLog.btnName},"%") 
	    	</if>	    	
	    	<if test="params.operaterLog.userID !=null  and params.operaterLog.userID!=''">
	    	    and UserID LIKE CONCAT("%",#{params.operaterLog.userID},"%")  
	    	</if>
	    	<if test="params.operaterLog.logStatus!=null and params.operaterLog.logStatus!=''">
				and LogStatus=#{params.operaterLog.logStatus}
			</if>			
			<if test="params.operaterLog.createDateBagin != null and params.operaterLog.createDateBagin !='' " >
      			 and RecTime &gt;=  UNIX_TIMESTAMP(#{params.operaterLog.createDateBagin})
		    </if>
		    <if test="params.operaterLog.createDateEnd != null and params.operaterLog.createDateEnd !='' " >
		      	 and RecTime &lt;=  UNIX_TIMESTAMP(#{params.operaterLog.createDateEnd})
		    </if>
		</where>		
		ORDER BY RecTime DESC
	</select>
	
	<select id="queryOperateLogsById" parameterType="java.lang.String" resultMap="OperateLogsResultMap">
	    SELECT  
     	<include refid="fieldList"></include>
     	FROM log_OperaterLog 
	     WHERE 
	     LogID = #{id}
	</select>
	
	<insert id="insert" parameterType="com.mopon.entity.log.OperaterLog">
	 INSERT INTO  log_OperaterLog
     (
	     SysLogID,
	     MenuID,
	     MenuName,
	     BtnName,
	     UserID,
	     UserName,
	     DataChangeInfos,
	     Memo,
	     LogStatus,
	     RecTime
     )
     VALUES
     (
	     #{sysLogID},
	     #{menuID},
	     #{menuName},
	     #{btnName},
	     #{userID},
	     #{userName},
	     #{dataChangeInfos},
	     #{memo},
	     #{logStatus},
	     #{recTime}
     )	
	</insert>
	
	</mapper>